<!doctype html>
{% load static %}
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static '/User/side-menu.css' %}">

    <script src="https://kit.fontawesome.com/7507e36a2a.js" crossorigin="anonymous"></script>
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
      <!-- Development version -->
<script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.js"></script>

<!-- Production version -->
<script src="https://unpkg.com/@popperjs/core@2"></script>
    <title>Retailor</title>
  </head>
  <style>
    body{
        background-color: #efefef;
    }
    .navbar {
        margin-bottom: 85px;
    }

    .navbar-brand {
        font-weight: 700;
        margin-left: 77px;
        color: #ffffff;
    }

    .nav-link {
        font-weight: 500;
    }

   
    .navbar-expand-lg .navbar-nav .nav-link {
        color: #ffffff;
    }

 

      .search_container {
        margin: auto;
        margin-bottom: 40px;
        margin-left: 300px;
  
  
        width: 60%;
        /* border: 3px solid black; */
        border-radius: 15px;
        padding: 44px;
        padding-left: 70px;
        padding-right: 70px;
        box-shadow: 0 14px 20px rgba(0, 0, 0, 1);
        /* visibility: hidden; */
        background-color: #ffffff;
        display: none;
  
      }

      .view_container{
        margin: auto;
        margin-bottom: 40px;
        margin-left: 300px;
  
  
        width: 60%;
        /* border: 3px solid black; */
        border-radius: 15px;
        padding: 44px;
        padding-left: 70px;
        padding-right: 70px;
        box-shadow: 0 14px 20px rgba(0, 0, 0, 1);
        /* visibility: hidden; */
        background-color: #ffffff;
      }

      .col-md-3
  {
  display: inline-block;
  margin-left:-4px;
  }
  .carousel-indicators .active {
  background-color: blue;
  }
  .col-md-3 img{
  width: 170px;
  height: 200px;
  }
  body .carousel-indicator li{
  background-color: blue;
  }
  body .carousel-indicators{
  bottom: -40px;
  }
  .carousel-indicators li {
  
  
      background-color: #7270fc;
  }
  body .carousel-control-prev-icon,
  body .carousel-control-next-icon{
  background-color: blue;
  }
  .carousel-control-prev,
  .carousel-control-next{
  top: auto;
  bottom: auto;
  padding-top: 222px;
  }
  body .no-padding{
  padding-left: 0,
  padding-right: 0;
  }
</style>

<body>




    <!-- <nav class="navbar navbar-expand-lg"
        style="background: linear-gradient(120deg, #ff6600, #f2f2f2, #009933); box-shadow: 0 8px 8px -4px lightblue;"> -->
    <!-- <nav class="navbar navbar-expand-lg"
        style="background: linear-gradient(145deg, #71b7e6, #9b59b6); box-shadow: 0 8px 8px -4px lightblue;"> -->
        <nav class="navbar navbar-expand-lg"
        style="background: #003a55;">
        <div class="container-fluid">
            <a class="navbar-brand" href="/index.html">FSC</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="{% url 'distributor' %}">Home</a>
                    </li>
                    {{user.is_retailor}}


                </ul>

                {% if user.is_authenticated %}
                <ul class="navbar-nav mr-2">
                    <button type="button" class="btn btn-secondary mx-2" id="popcart" data-container="body" data-toggle="popover" data-placement="bottom" data-html="true" data-content="Vivamus
sagittis lacus vel augue laoreet rutrum faucibus.">


  Cart(<span id="cart">0</span>)
</button>

                  <li class="nav-item dropdown">
                  {% comment %} <li class="nav-item dropdown">{{user.user_address}}</li> {% endcomment %}
                    <a class="nav-link dropdown-toggle" href='#' id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                      Welcome {{request.user}}</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <a class="dropdown-item" href="{% url 'handleLogout' %}">Logout</a>
        
                    </div>
                  </li>
                </ul>
              </div>
              {% else %}
              <!-- Button to  trigger Login modal -->
              <button type="button" class="btn btn-primary mr-2 linear-bg-btn" data-toggle="modal" data-target="#loginModal">
                Login
              </button>
        
              <button type="button" class="btn btn-primary mr-2 linear-bg-btn" data-toggle="modal" data-target="#signupModal">
                SignUp
              </button>
              {% endif %}

            </div>
        </div>

    </nav>

    <div class="sidebar">
        <div class="logo-details">
            <div class="logo_name">LRS</div>
            <i class='bx bx-menu' id="btn"></i>
        </div>
        <ul class="nav-list p-f">
            <li>
                <a href="/view_property.html">
                  <i class="fa-solid fa-magnifying-glass"></i>
                  <span class="links_name">SEARCH RECORDS</span>
                </a>
                <span class="tooltip">SEARCH RECORDS</span>
              </li>
              <li>
                <a href="javascript:addOrder()">
    
                    <i class="fa-solid fa-plus"></i>
                    <span class="links_name">ADD RECORD</span>
                </a>
                <span class="tooltip">ADD RECORD</span>
            </li>
              

            
            
    
            <li class="profile">
                <div class="profile-details">
                    <img src="./img/face-1.png" alt="profileImg">
                    <div class="name_job">
                        <div class="name">Suraj</div>
                        <div class="job">Retailer</div>
                    </div>
                </div>
                <a href="{% url 'handleLogout' %}">
                    <i class='bx bx-log-out' href="{% url 'handleLogout' %}" id="log_out" style="color: #ffffff;"></i>
                </a>
            </li>
        </ul>
    </div>



    <div class="container">
        <!--Slideshow starts here -->
        {% for product, range, nSlides in allProds %}
        <h5 class="my-4">Flash Sale On {{product.0.category}} - Recommended Items</h5>
        <div class="row">
            <div id="demo{{forloop.counter}}" class="col carousel slide my-3" data-ride="carousel">
                <ul class="carousel-indicators">
                    <li data-target="#demo{{forloop.counter}}" data-slide-to="0" class="active"></li>
                    {% for i in range %}
                    <li data-target="#demo{{forloop.parentloop.counter}}" data-slide-to="{{i}}"></li>
                    {% endfor %}
                </ul>
                <div class="container carousel-inner no-padding">
                    <div class="carousel-item active">
                        {% for i in product %}
                        <div class="col-xs-3 col-sm-3 col-md-3">
                            <div class="card align-items-center" style="width: 18rem;">
                                <img src='/media/{{i.image}}' class="card-img-top" alt="...">
                                <div class="card-body">
                                    <h5 class="card-title" id="namepr{{i.id}}">{{i.product_name}}</h5>
                                    <p class="card-text">{{i.desc|slice:"0:53"}}...</p>
                                    <h6 class="card-title" >Price: <span id="pricepr{{i.id}}">{{i.price}}</span></h6>
                                    <span id="divpr{{i.id}}" class="divpr">
                                        <button id="pr{{i.id}}" class="btn btn-primary cart" style="border-radius: 20px;">Add To Cart</button>
                                    </span>
                                    <a href="/products/{{i.id}}"><button id="qv{{i.id}}" class="btn btn-primary cart" style="border-radius: 20px;">QuickView</button></a>
                                </div>
                            </div>
                        </div>
                        {% if forloop.counter|divisibleby:4 and forloop.counter > 0 and not forloop.last %}
                    </div>
                    <div class="carousel-item">
                        {% endif %}
                        {% endfor %}
                    </div>
                </div>
            </div>
            <!-- left and right controls for the slide -->
            <a class="carousel-control-prev" href="#demo{{forloop.counter}}" data-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" href="#demo{{forloop.counter}}" data-slide="next">
                <span class="carousel-control-next-icon"></span>
            </a>
        </div>
        {% endfor %}
    </div>
    
    



    <div class="search_container" id="search_container">
        <form action="/retailor" method="POST">
        {% csrf_token%}
        <h4 class="text-center" style="margin-bottom: 40px; font-size: 18px;">Enter Tracking ID Below</h4>
        <!-- <form> -->
        <div class="form-row">
          <div class="col text-center">

            <input type="text" id="search_input" name="search_input" class="form-control text-center"
              placeholder="Enter Food Tracking ID" style="  width: 100%; margin-bottom: 20px;
      height: 40px; font-size: 13px;" required>

            <button type="submit"
              id="searchrecordbtn"  name="searchrecordbtn" class=" btn btn-primary btn-sm btn-w-h modal-linear-bg-btn" style="width: 165px; margin: 0 0 0px 29px;
           font-size: 12px;">Search</button>
       

          </div>
          
          
        </div>
    </form> 

    {% comment %} <h1>Details of crop:</h1>
            <h2>{{Ofarmerid}}</h2>
            <h2>{{Ocropname}}</h2>
            <h2>{{Ocropqt}}</h2>
            <h2>{{Ocropprice}}</h2>
            <h2>{{Osdate}}</h2>
            <br>
            <br>
            <h1>Details of Farmer:</h1>
            
            <h2>{{Ofarmername}}</h2>
            <h2>{{Ofkycid}}</h2>
            <h2>{{Ofaddress}}</h2> {% endcomment %}
            {% comment %} <h2>{{Ofstate}}</h2>
            <h2>{{Ofpincode}}</h2> {% endcomment %}
            {% comment %} <h2>{{Ofcontact}}</h2>
            <br>
            <br>

            <h1>Details of Distributor:</h1>
            <h2>{{Odistributorname}}</h2>
            <h2>{{Odkycid}}</h2>
            <h2>{{Odaddress}}</h2> {% endcomment %}
            {% comment %} <h2>{{Odstate}}</h2>
            <h2>{{Odpincode}}</h2> {% endcomment %}
            {% comment %} <h2>{{Odcontact}}</h2> {% endcomment %}

      </div>




 
        <div class="view_container">
            <h3 class="text-center">ADD Crop Purchase Details:</h3>
            <br>
            <form action="/retailor" method="POST">
                {% csrf_token %}
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Farmer ID</span>

                    <input type="text" class="form-control" aria-label="Sizing example input" id="farmerid" name="farmerid" aria-describedby="inputGroup-sizing-sm" value="{{Ofarmerid}}">
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Crop Name</span>
                    <span id="cropname" name="cropname" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ocropname}}</span>
                    
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Crop Quantity</span>
                    <span id="cropqt" name="cropqt" name="cropname" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ocropqt}}</span>
                    
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Selling Price</span>
                    <span id="cropprice" name="cropprice" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ocropprice}}</span>
                    
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Selling Date</span>
                    <span id="sdate" name="sdate" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Osdate}}</span>
                    
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Farmer Name</span>
                    <span id="farmername" name="farmername" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ofarmername}}</span>
                </div>
                {% comment %} <div class="input-group mb-3">
                    <label class="input-group-text label-width" for="inputGroupFile01">Upload Crop Image</label>
                    <input type="file" class="form-control" name="imgfile" id="inputGroupFile01">
                </div> {% endcomment %}
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Farmer's KYC ID</span>
                    <span id="fkycid" name="fkycid" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ofkycid}}</span>
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Farmer's Address</span>
                    <span id="fcity" name="fcity" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ofaddress}}</span>
                </div>
                {% comment %} <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Farmer's State</span>
                    <span id="fstate" name="fstate" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ofstate}}</span>
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Farmer's Pincode</span>
                    <span id="fpincode" name="fpincode" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Ofpincode}}</span>
                </div> {% endcomment %}
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Farmer's Contact No</span>
                    <span id="fcontact" name="fcontact" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">+91 {{Ofcontact}}</span>
                </div>
                
                
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Distributor Name</span>
                    <span id="distributorname" name="distributorname" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Odistributorname}}</span>
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Distributor's kyc</span>
                    <span id="dkycid" name="dkycid" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Odkycid}}</span>
                </div>
                
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Distributor's Address</span>
                    <span id="dcity" name="dcity" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Odaddress}}</span>
                </div>
                {% comment %} <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Distributor's State</span>
                    <span id="dstate" name="dstate" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Odstate}}</span>
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Distributor's Pincode</span>
                    <span id="dpincode" name="dpincode" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">{{Odpincode}}</span>
                </div> {% endcomment %}
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Distributor's contact</span>
                    <span id="dcontact" name="dcontact" class="form-control" aria-label="small" aria-describedby="inputGroup-sizing-sm">+91 {{Odcontact}}</span>
                </div>


                {% comment %} <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Retailor Name</span>
                    <input type="text" class="form-control" aria-label="Sizing example input" id="retailername" name="retailername" aria-describedby="inputGroup-sizing-sm">
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Retailor's kyc</span>
                    <input type="text" class="form-control" aria-label="Sizing example input" id="rkycid" name="rkycid" aria-describedby="inputGroup-sizing-sm">
                </div>
    
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Retailor's Address</span>
                    <input type="text" class="form-control" aria-label="Sizing example input" id="raddress" name="raddress" aria-describedby="inputGroup-sizing-sm">
                </div> {% endcomment %}
                {% comment %} <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Retailor's State</span>
                    <input type="text" class="form-control" aria-label="Sizing example input" id="rstate" name="rstate" aria-describedby="inputGroup-sizing-sm">
                </div>
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Retailor's Pincode</span>
                    <input type="text" class="form-control" aria-label="Sizing example input" id="rpincode" name="rpincode" aria-describedby="inputGroup-sizing-sm">
                </div> {% endcomment %}
                {% comment %} <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text label-width" id="inputGroup-sizing-sm">Retailor's contact</span>
                    <input type="text" class="form-control" aria-label="Sizing example input" id="rcontact" name="rcontact" aria-describedby="inputGroup-sizing-sm">
                </div> {% endcomment %}
                <button class="btn btn-outline-secondary" name="addrecordbtn" type="submit">Verify and Submit</button>
                    
            </form>    </div>
     




    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->
    <script src="{%static '/User/side-menu.js'%}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
      crossorigin="anonymous"></script>

      <script src="https://code.jquery.com/jquery-3.3.1.js"
      integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
      crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
      <script>window.jQuery || document.write('<script src="/docs/4.5/assets/js/vendor/jquery.slim.min.js"><\/script>')</script><script src="/docs/4.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-LtrjvnR4Twt/qOuYxE721u19sVFLVSA4hf/rRt6PrZTmiPltdZcI7q7PXQBYTKyf" crossorigin="anonymous"></script>

    
      <script>
        function addOrder() {
               // document.getElementById('search_container').style.visibility= "visible";
               document.getElementById('search_container').style.display= "block";
           }
       </script>


       <script>
    
        // Find out the cart items from localStorage
        if (localStorage.getItem('cart') == null) {
            var cart = {};
        } else {
            cart = JSON.parse(localStorage.getItem('cart'));
            updateCart(cart);
        }
        
        // If the add to cart button is clicked, add/increment the item
        //$('.cart').click(function() {
            $('.divpr').on('click', 'button.cart', function(){
            var idstr = this.id.toString();
            if (cart[idstr] != undefined) {
                qty = cart[idstr][0] + 1;
            } else {
                qty = 1;
                name = document.getElementById('name'+idstr).innerHTML;
                price = document.getElementById('price'+idstr).innerHTML;
                cart[idstr] = [qty, name, parseInt(price)];
        
            }
            updateCart(cart);
        
        });
        
        //Add Popover to cart
        $('#popcart').popover();
        updatePopover(cart);
        
        function updatePopover(cart) {
            console.log('We are inside updatePopover');
            var popStr = "";
            popStr = popStr + "<h5> Your Order Cart </h5><div class='mx-2 my-2'>";
            var i = 1;
            for (var item in cart) {
                popStr = popStr + "<b>" + i + "</b>. ";
                popStr = popStr + document.getElementById('name' + item).innerHTML.slice(0, 19) + "... Qty: " + cart[item][0] + '<br>';
                i = i + 1;
        
            }
        
            popStr = popStr + "</div> <a href='/checkout'><button class='btn btn-primary' id ='checkout'>Checkout</button></a> <button class='btn btn-primary' onclick='clearCart()' id ='clearCart'>Clear Cart</button>     "
            console.log(popStr);
            document.getElementById('popcart').setAttribute('data-content', popStr);
            $('#popcart').popover();
        
        }
        
        function clearCart() {
            cart = JSON.parse(localStorage.getItem('cart'));
            for (var item in cart) {
                document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-primary cart">Add To Cart</button>'
            }
            localStorage.clear();
            cart = {};
            updateCart(cart);
        
        
        }
        
        function updateCart(cart) {
            var sum = 0;
            for (var item in cart) {
                sum = sum + cart[item][0];
                document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";
        
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            document.getElementById('cart').innerHTML = sum;
            console.log(cart);
            updatePopover(cart);
        }
        
        // If plus or minus button is clicked, change the cart as well as the display value
        $('.divpr').on("click", "button.minus", function() {
            a = this.id.slice(7, );
            cart['pr' + a][0] = cart['pr' + a][0] - 1;
            cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
            if (cart['pr' + a][0] == 0){
                document.getElementById('divpr' + a).innerHTML = '<button id="pr'+a+'" class="btn btn-primary cart">Add to Cart</button>';
                delete cart['pr'+a];
            }
            else{
                document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
            }
            updateCart(cart);
        
        });
        
        $('.divpr').on("click", "button.plus", function() {
            a = this.id.slice(6, );
            cart['pr' + a][0] = cart['pr' + a][0] + 1;
            document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
            updateCart(cart);
        });
          </script>
        
        
        
        
        
        
        
        
        
          <script>
            if (localStorage.getItem('cart') == null) {
                var cart = {};
            } else {
                cart = JSON.parse(localStorage.getItem('cart'));
            
            }
            console.log(cart);
            var sum = 0;
            var totalPrice = 0;
            
            if ($.isEmptyObject(cart)) {
                //if object is empty
                mystr = `<p>Your cart is empty, please add some items to your cart before checking out!</p>`
                $('#items').append(mystr);
            } else {
                for (item in cart) {
                    let name = cart[item][1];
                    let qty = cart[item][0];
                    let itemPrice = cart[item][2];
                    sum = sum + qty;
                    totalPrice = totalPrice + qty* itemPrice;
                    mystr = `<li class="list-group-item d-flex justify-content-between align-items-center">
                                ${name}
                                <span class="badge badge-primary badge-pill">${qty}</span>
                            </li>`
                    $('#items').append(mystr);
                }
            
            }
            
            document.getElementById('cart').innerHTML = sum;
            document.getElementById('totalPrice').innerHTML = totalPrice;
            $('#itemsJson').val(JSON.stringify(cart));
            {% if thank %}
            alert('Thanks for ordering with us. Your order is is {{id}}. Use it to track your order using our order tracker');
            localStorage.clear();
            document.location = "/shop";
            {% endif %}
            $('#amount').val($('#totalPrice').html())
            </script>
        
        
        
        
   

  </body>
</html>